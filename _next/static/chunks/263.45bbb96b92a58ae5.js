!function(){var e,t,a,o,i,r,n={8263:function(e,t,a){"use strict";var o=a(3302);class i{seededRandom(e){let t=e;return()=>(t=1e4*Math.sin(t))-Math.floor(t)}fade(e){return e*e*e*(e*(6*e-15)+10)}lerp(e,t,a){return t+e*(a-t)}grad(e,t,a){let o=7&e,i=o<4?t:a,r=o<4?a:t;return((1&o)==0?i:-i)+((2&o)==0?r:-r)}noise(e,t){let a=255&Math.floor(e),o=255&Math.floor(t);e-=Math.floor(e),t-=Math.floor(t);let i=this.fade(e),r=this.fade(t),n=this.p[a]+o,l=this.p[a+1]+o,s=this.lerp(r,this.lerp(i,this.grad(this.p[n],e,t),this.grad(this.p[l],e-1,t)),this.lerp(i,this.grad(this.p[n+1],e,t-1),this.grad(this.p[l+1],e-1,t-1)));return(s+1)/2}fbm(e,t,a,o,i){let r=0,n=1,l=1,s=0;for(let d=0;d<a;d++)r+=this.noise(e*n,t*n)*l,s+=l,l*=o,n*=i;return r/s}constructor(e){this.p=[];let t=e?this.seededRandom(e):Math.random;for(let e=0;e<256;e++)this.p[e]=e;let a=256;for(;a>1;){a--;let e=Math.floor(t()*(a+1)),o=this.p[e];this.p[e]=this.p[a],this.p[a]=o}this.p.push(...this.p)}}function r(e,t,a,o){let r=o||new i(a),n={};for(let a=0;a<16;a++)for(let o=0;o<16;o++){let i=16*e+o,l=16*t+a,s=r.fbm(i/8,l/10,2,.5,2),d=r.fbm(i/8,l/10,2,.4,2),c=r.fbm(i/8,l/8,2,.8,2),u="grass";d>.6&&(u="dirt"),c>.7&&(u="stone"),s<.35&&(u="water");let p={x:i,y:l,type:u,dirtAutotile:0,grassAutotile:0,stoneAutotile:0};n["".concat(i,",").concat(l)]=p}return n}let n=(e,t,a)=>{let o=0,i=0,r=0;for(let n of[{dx:0,dy:-1,mask:1},{dx:1,dy:0,mask:2},{dx:0,dy:1,mask:4},{dx:-1,dy:0,mask:8}]){let l=a["".concat(e+n.dx,",").concat(t+n.dy)],s=l?l.type:"water";("dirt"===s||"water"===s)&&(o|=n.mask),"water"===s&&(i|=n.mask),("grass"===s||"dirt"===s||"water"===s)&&(r|=n.mask)}return{grassAutotile:15-o,dirtAutotile:15-i,stoneAutotile:15-r}};var l=JSON.parse('{"economy":{"baseProduction":0.5,"productionGrowthFactor":2,"baseCost":50,"costGrowthFactor":3,"costFactor":1.18,"buildingCostFactor":2,"bonusValueFactor":0.05},"ir":0.25,"LQ":{"tree":{"threshold":25,"maxSize":100,"name":"Forest","bonus":0.25},"flower":{"threshold":25,"maxSize":100,"name":"Garden","bonus":0.25},"vegetable":{"threshold":25,"maxSize":100,"name":"Plantation","bonus":0.35}},"OF":{"Q7":300,"ei":2.5,"Rb":0.2},"DJ":{"_comment_costMultiplier":"The upgrade cost is based on the item\'s base cost times this multiplier.","costMultiplier":100,"_comment_costFactor":"How much the upgrade cost increases for each subsequent level. Formula: upgradeCost * (factor ^ (currentLevel - 1)).","costFactor":5,"_comment_productionMultiplier":"The production bonus per level for an item. 1.0 means +100% of base SPS per level.","productionMultiplier":1,"_comment_itemCountRequirement":"The number of items of a specific type you must own to unlock the first upgrade.","itemCountRequirement":25,"_comment_itemCountRequirementFactor":"How the item count requirement increases for subsequent upgrade levels.","itemCountRequirementFactor":2},"aY":{"costMultiplier":75,"costFactor":3.5,"_comment_productionMultiplier":"Production bonus for buildings that produce seeds directly.","productionMultiplier":2,"_comment_bonusValueIncrease":"How much the percentage bonus of a building increases per level (e.g., a well\'s bonus).","bonusValueIncrease":0.25,"itemCountRequirement":2,"itemCountRequirementFactor":2},"ez":{"costMultiplier":10,"costFactor":3.5,"_comment_costReductionValue":"The percentage (0.5 = 50%) by which the item\'s own cost is reduced per upgrade level.","costReductionValue":0.5,"itemCountRequirement":2,"itemCountRequirementFactor":2},"tS":{"costMultiplier":25000,"costFactor":4,"_comment_bonusMultiplier":"A fixed bonus added to the group\'s production multiplier each time it\'s upgraded.","bonusMultiplier":0.25,"groupCountRequirement":1,"groupCountRequirementFactor":2},"SR":{"production":{"name":"Global Production","costBase":1000,"costFactor":10,"bonusValue":0.1,"_comment_unlockTrigger":"When this upgrade becomes available. Unlocks based on total seeds produced.","unlockTrigger":{"type":"totalSeeds","base":500,"factor":20}},"click":{"name":"Click Power","costBase":250,"costFactor":2.5,"_comment_bonusValue":"Multiplier for manual clicks. A value of 2.0 means it doubles click power each level.","bonusValue":2,"unlockTrigger":{"type":"totalSeeds","base":250,"factor":3}}},"rc":{"costMultiplier":10000,"costFactor":5,"radiusIncrease":1,"unlockTrigger":{"type":"totalSeeds","base":100000,"factor":20}}}');function s(e){let t,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{worldName:i="My World",avatarUrl:s="/items/avatar_man.png"}=o,d=Math.floor(1e6*Math.random()),c={};for(let e=-1;e<=1;e++)for(let t=-1;t<=1;t++){let a=r(t,e,d);c={...c,...a}}let u=0,p=e.home_base;if(!p)throw Error("home_base item not found!");for(;u<100;){let e=Math.floor(u/10),o=Math.floor(Math.random()*(2*e+1))-e,i=Math.floor(Math.random()*(2*e+1))-e,r=!0;for(let e=0;e<(p.height||1);e++){for(let t=0;t<(p.width||1);t++){let a="".concat(o+t,",").concat(i+e);if(!c[a]||"water"===c[a].type){r=!1;break}}if(!r)break}if(r){t=o,a=i;break}u++}void 0===t&&(t=0,a=0);let y=Date.now();for(let e=0;e<(p.height||1);e++)for(let o=0;o<(p.width||1);o++){let i=t+o,r=a+e,n="".concat(i,",").concat(r),l=0===o&&0===e;c[n]={...c[n]||{x:i,y:r,type:"grass"},item:{id:p.id,placedAt:y,rootTile:l?void 0:{x:t,y:a}}}}let m={...c};for(let e in m){let t=m[e],{dirtAutotile:a,grassAutotile:o,stoneAutotile:i}=n(t.x,t.y,m);m[e]={...t,dirtAutotile:a,grassAutotile:o,stoneAutotile:i}}return{gridData:m,playerStats:{worldName:i,avatarUrl:s,seeds:100,totalSeedsProduced:0,manualSeedsGenerated:0,upgradesPurchased:0,totalTimePlayed:0,level:1,xpForCurrentLevel:0,xpForNextLevel:l.OF.Q7,unlockedAchievements:[],completedMissions:[],itemLevels:{},groupLevels:{},globalLevels:{},waterAdjacencyLevel:1,categoryMultipliers:{},homePosition:{x:t,y:a}},worldSeed:d,lastSaveTimestamp:Date.now(),totalSeedsPerSecond:0,isRaining:!1,rainStartTime:0,activeTooltipTileKey:null}}a(7579).lW;let d={tree:"Forest",flower:"Garden",vegetable:"Plantation"};function c(e,t,a,o){let i=a["".concat(e,",").concat(t)];if(!(null==i?void 0:i.item))return{tiles:[],size:0,name:""};let r=o[i.item.id];if(!r)return{tiles:[i],size:1,name:"Unknown Item"};let n=r.category,l={tiles:[],size:0,name:d[n]||r.name},s=[[e,t]],c=new Set(["".concat(e,",").concat(t)]);for(;s.length>0;){let[e,t]=s.shift(),i=a["".concat(e,",").concat(t)];if(i&&i.item){let r=o[i.item.id];if((null==r?void 0:r.category)===n)for(let[r,d]of(l.tiles.push(i),l.size++,[[e,t-1],[e+1,t],[e,t+1],[e-1,t]])){let e="".concat(r,",").concat(d);if(!c.has(e)){c.add(e);let t=a[e];if(null==t?void 0:t.item){let e=o[t.item.id];(null==e?void 0:e.category)===n&&s.push([r,d])}}}}}return l}let u={vegetable:{id:"vegetable",name:"Vegetables",icon:"/items/vegetable_hay.png"},flower:{id:"flower",name:"Flowers",icon:"/items/flower_daisy.png"},tree:{id:"tree",name:"Trees",icon:"/items/tree_oak.png"},building:{id:"building",name:"Buildings",icon:"/items/building_well.png"},decoration:{id:"decoration",name:"Decorations",icon:"/items/road_stones.png"}};var p=JSON.parse('[{"id":"seedling_start","name":"Seedling\'s Start","description":"You\'ve planted your first seed, beginning a journey of immense growth.","condition":{"type":"totalSeeds","value":100},"reward":{"type":"instantSeeds","value":20,"description":"+20 seeds"}},{"id":"first_growth","name":"First Growth","description":"A tiny sprout breaks through the soil, a promise of the forest to come.","condition":{"type":"totalSeeds","value":500},"reward":{"type":"instantSeeds","value":100,"description":"+100 seeds"}},{"id":"patch_of_green","name":"Patch of Green","description":"Your garden is no longer a single sprout but a noticeable patch of life.","condition":{"type":"totalSeeds","value":2500},"reward":{"type":"instantSeeds","value":500,"description":"+500 seeds"}},{"id":"garden_plot","name":"Garden Plot","description":"You\'re learning to cultivate the land, turning soil into sustenance.","condition":{"type":"totalSeeds","value":10000},"reward":{"type":"instantSeeds","value":2000,"description":"+2,000 seeds"}},{"id":"thriving_meadow","name":"Thriving Meadow","description":"Wildflowers and grasses sway in the breeze, a testament to your efforts.","condition":{"type":"totalSeeds","value":50000},"reward":{"type":"instantSeeds","value":10000,"description":"+10,000 seeds"}},{"id":"budding_grove","name":"Budding Grove","description":"Young trees stand together, their collective strength shaping the landscape.","condition":{"type":"totalSeeds","value":200000},"reward":{"type":"instantSeeds","value":40000,"description":"+40,000 seeds"}},{"id":"verdant_expanse","name":"Verdant Expanse","description":"Your influence spreads, turning barren land into a lush paradise.","condition":{"type":"totalSeeds","value":800000},"reward":{"type":"instantSeeds","value":160000,"description":"+160,000 seeds"}},{"id":"young_forest","name":"Young Forest","description":"A canopy begins to form, creating a new ecosystem beneath it.","condition":{"type":"totalSeeds","value":3000000},"reward":{"type":"instantSeeds","value":600000,"description":"+600,000 seeds"}},{"id":"ancient_woods","name":"Ancient Woods","description":"The trees whisper secrets of old, their roots deep in the earth you shaped.","condition":{"type":"totalSeeds","value":10000000},"reward":{"type":"instantSeeds","value":2000000,"description":"+2M seeds"}},{"id":"heart_of_the_forest","name":"Heart of the Forest","description":"You have created a place of immense power and profound tranquility.","condition":{"type":"totalSeeds","value":40000000},"reward":{"type":"instantSeeds","value":8000000,"description":"+8M seeds"}},{"id":"valley_carver","name":"Valley Carver","description":"Rivers and hills bend to your will, forming a perfect, thriving valley.","condition":{"type":"totalSeeds","value":150000000},"reward":{"type":"instantSeeds","value":30000000,"description":"+30M seeds"}},{"id":"continental_gardener","name":"Continental Gardener","description":"Your garden knows no borders, spanning entire landmasses.","condition":{"type":"totalSeeds","value":600000000},"reward":{"type":"instantSeeds","value":120000000,"description":"+120M seeds"}},{"id":"planet_of_bloom","name":"Planet of Bloom","description":"From space, your world is a jewel of green and blue.","condition":{"type":"totalSeeds","value":2500000000},"reward":{"type":"instantSeeds","value":500000000,"description":"+500M seeds"}},{"id":"system_of_life","name":"System of Life","description":"Neighboring planets show signs of your verdant touch.","condition":{"type":"totalSeeds","value":10000000000},"reward":{"type":"instantSeeds","value":2000000000,"description":"Instant +2 Billion Seeds"}},{"id":"nebula_of_seeds","name":"Nebula of Seeds","description":"You cast your seeds into the cosmos, creating new gardens among the stars.","condition":{"type":"totalSeeds","value":50000000000},"reward":{"type":"instantSeeds","value":10000000000,"description":"Instant +10 Billion Seeds"}},{"id":"galactic_core","name":"Galactic Core","description":"The center of the galaxy is a swirling vortex of your creation.","condition":{"type":"totalSeeds","value":200000000000},"reward":{"type":"instantSeeds","value":40000000000,"description":"Instant +40 Billion Seeds"}},{"id":"supercluster_farmer","name":"Supercluster Farmer","description":"You cultivate not just galaxies, but clusters of them.","condition":{"type":"totalSeeds","value":1000000000000},"reward":{"type":"instantSeeds","value":200000000000,"description":"Instant +200 Billion Seeds"}},{"id":"cosmic_filament","name":"Cosmic Filament","description":"The very structure of the universe is woven from your creations.","condition":{"type":"totalSeeds","value":4000000000000},"reward":{"type":"instantSeeds","value":800000000000,"description":"Instant +800 Billion Seeds"}},{"id":"universal_architect","name":"Universal Architect","description":"You design and build universes with the ease of a simple gardener.","condition":{"type":"totalSeeds","value":15000000000000},"reward":{"type":"instantSeeds","value":3000000000000,"description":"Instant +3 Trillion Seeds"}},{"id":"multiverse_of_green","name":"Multiverse of Green","description":"An infinite number of universes, all thriving under your care.","condition":{"type":"totalSeeds","value":60000000000000},"reward":{"type":"instantSeeds","value":12000000000000,"description":"Instant +12 Trillion Seeds"}},{"id":"the_first_seed","name":"The First Seed","description":"You have become the origin point from which all growth begins.","condition":{"type":"totalSeeds","value":250000000000000},"reward":{"type":"instantSeeds","value":50000000000000,"description":"Instant +50 Trillion Seeds"}},{"id":"concept_of_growth","name":"Concept of Growth","description":"You are no longer a gardener; you are the very idea of growth itself.","condition":{"type":"totalSeeds","value":1000000000000000},"reward":{"type":"instantSeeds","value":200000000000000,"description":"Instant +200 Trillion Seeds"}},{"id":"the_unfolding","name":"The Unfolding","description":"Reality itself unfolds like a leaf at your command.","condition":{"type":"totalSeeds","value":5000000000000000},"reward":{"type":"instantSeeds","value":1000000000000000,"description":"Instant +1 Quadrillion Seeds"}},{"id":"beyond_infinity","name":"Beyond Infinity","description":"You have surpassed all known limits of creation.","condition":{"type":"totalSeeds","value":20000000000000000},"reward":{"type":"instantSeeds","value":4000000000000000,"description":"Instant +4 Quadrillion Seeds"}},{"id":"the_final_bloom","name":"The Final Bloom","description":"The ultimate expression of life has been achieved.","condition":{"type":"totalSeeds","value":100000000000000000},"reward":{"type":"instantSeeds","value":20000000000000000,"description":"Instant +20 Quadrillion Seeds"}},{"id":"hyperdimensional_harvest","name":"Hyperdimensional Harvest","description":"You reap what you sow across dimensions beyond comprehension.","condition":{"type":"totalSeeds","value":400000000000000000},"reward":{"type":"instantSeeds","value":80000000000000000,"description":"Instant +80 Quadrillion Seeds"}},{"id":"omega_point","name":"Omega Point","description":"You have reached the final, ultimate state of complexity and consciousness.","condition":{"type":"totalSeeds","value":1500000000000000000},"reward":{"type":"instantSeeds","value":300000000000000000,"description":"Instant +300 Quadrillion Seeds"}},{"id":"transcendence","name":"Transcendence","description":"You exist beyond the physical realm, a being of pure, generative energy.","condition":{"type":"totalSeeds","value":6000000000000000000},"reward":{"type":"instantSeeds","value":1200000000000000000,"description":"Instant +1.2 Quintillion Seeds"}},{"id":"the_great_stillness","name":"The Great Stillness","description":"Having created everything, you can finally rest.","condition":{"type":"totalSeeds","value":25000000000000000000},"reward":{"type":"instantSeeds","value":5000000000000000000,"description":"Instant +5 Quintillion Seeds"}},{"id":"idle_mastery","name":"Idle Mastery","description":"You have achieved everything. The cycle is complete. Congratulations.","condition":{"type":"totalSeeds","value":100000000000000000000},"reward":{"type":"instantSeeds","value":20000000000000000000,"description":"Instant +20 Quintillion Seeds"}}]');function y(e,t,a){return Math.floor(e*Math.pow(a,t-1))}function m(e){return e<=1?0:l.OF.Q7*Math.pow(l.OF.ei,e-2)}function f(e){return e<l.OF.Q7?1:Math.floor(Math.log(e/l.OF.Q7)/Math.log(l.OF.ei))+2}function g(e,t,a){var o,i,r;let n=e.seedsPerSecond||0;if(0===n)return 0;let s=(null===(o=t.itemLevels)||void 0===o?void 0:o[e.id])||1,d=n;"costReduction"!==e.upgradeType&&s>1&&(d=n*(1+(s-1)*("building"===e.category?l.aY:l.DJ).productionMultiplier));let c=a.group+a.building+a.water,u=1,y=(null===(i=t.globalLevels)||void 0===i?void 0:i.production)||1;y>1&&(u+=(y-1)*l.SR.production.bonusValue),(t.unlockedAchievements||[]).forEach(e=>{let t=p.find(t=>t.id===e);t&&"globalMultiplier"===t.reward.type&&(u*=t.reward.value)});let m=(null===(r=t.categoryMultipliers)||void 0===r?void 0:r[e.category])||1;return d*(1+c)*u*m}let v={tree:"/items/icon-forest.png",flower:"/items/icon-garden.png",vegetable:"/items/icon-plantation.png"};var h=JSON.parse('[{"id":"generate_100_manual_seeds","name":"Generate 100 seeds from clicks","description":"Click the large seed button at the bottom of the screen 100 times to gather seeds manually.","reward":200,"icon":"/items/icon_seed.png","background":"grass","condition":{"type":"manualSeeds","value":100}},{"id":"first_upgrade","name":"Make your first upgrade","description":"Purchase any upgrade from the \'Upgrades\' panel on the right.","reward":400,"icon":"/items/icon_seed.png","background":"grass","condition":{"type":"upgrades","value":1}},{"id":"create_first_garden","name":"Create your first garden","description":"Place 25 or more Flowers next to each other to form a Garden and unlock a group production bonus.","reward":600,"icon":"/items/flower_daisy.png","background":"grass","condition":{"type":"groupCount","category":"flower","value":1}},{"id":"place_10_roads","name":"Place 10 roads","description":"Place 10 stone road tiles. You can find them in the \'Decorations\' category on the left.","reward":800,"icon":"/items/road_stones.png","background":"dirt","condition":{"type":"itemCount","itemId":"road_stone","value":10}},{"id":"place_first_well","name":"Place your first well","description":"Place a Well. Wells provide a production bonus to nearby crops.","reward":1000,"icon":"/items/building_well.png","background":"water","condition":{"type":"itemCount","itemId":"well","value":1}},{"id":"create_first_plantation","name":"Create your first plantation","description":"Place 25 or more Vegetables next to each other to form a Plantation for a large bonus.","reward":1500,"icon":"/items/vegetable_hay.png","background":"dirt","condition":{"type":"groupCount","category":"vegetable","value":1}},{"id":"place_first_handcart","name":"Place your first handcart","description":"Place a Handcart. It increases the bonus radius of nearby buildings.","reward":2000,"icon":"/items/building_handcart.png","background":"dirt","condition":{"type":"itemCount","itemId":"handcart","value":1}},{"id":"create_first_forest","name":"Create your first forest","description":"Place 25 or more Trees next to each other to form a Forest.","reward":3000,"icon":"/items/tree_oak.png","background":"grass","condition":{"type":"groupCount","category":"tree","value":1}}]');let S=null,b={},w=null,T=null,_=null,M=new Set,k=(e,t)=>{if(!t||!t.gridData)return 0;let a=0;for(let i in t.gridData){var o;let r=t.gridData[i];(null===(o=r.item)||void 0===o?void 0:o.id)===e&&!r.item.rootTile&&a++}return a},x=e=>{try{var t,a,o;if(!e)return{totalSeedsPerSecond:0,itemStats:{},categoryStats:{},allGroupTileKeys:new Set,waterAdjacentTileKeys:new Set,bonusesByTile:{},bonusRadiusTiles:new Set,availableUpgrades:[],activeTooltip:null,missionProgress:{},nextCosts:{},unlockedItems:[]};let i={};Object.values(b).forEach(e=>{i[e.id]={count:0,sps:0,item:e}});let r={},n=Object.values(b).sort((e,t)=>(e.difficulty||0)-(t.difficulty||0));for(let t in Object.keys(u).forEach(e=>{let t=u[e];r[e]={name:(null==t?void 0:t.name)||"Unknown",icon:(null==t?void 0:t.icon)||"â“",count:0,sps:0,firstItem:n.find(t=>t.category===e),groupCount:0,groupSps:0}}),e.gridData){let a=e.gridData[t];if(a.item&&!a.item.rootTile){i[a.item.id]&&i[a.item.id].count++;let e=b[a.item.id];e&&r[e.category]&&r[e.category].count++}}let s=Object.values(b).filter(e=>{var t;return!e.requiredItemId||!e.requiredItemCount||((null===(t=i[e.requiredItemId])||void 0===t?void 0:t.count)||0)>=e.requiredItemCount}),d=Object.values(e.gridData).filter(e=>{var t;return e.item&&(null===(t=b[e.item.id])||void 0===t?void 0:t.category)==="building"&&!e.item.rootTile}),p=d.filter(e=>{var t,a;return(null===(a=b[e.item.id])||void 0===a?void 0:null===(t=a.bonus)||void 0===t?void 0:t.type)==="radiusIncrease"}),m=d.filter(e=>{var t,a;return(null===(a=b[e.item.id])||void 0===a?void 0:null===(t=a.bonus)||void 0===t?void 0:t.type)==="production"}),f={};for(let e of m){let t="".concat(e.x,",").concat(e.y),a=b[e.item.id];if(!a||!a.bonus||"production"!==a.bonus.type)continue;let o=a.bonus.radius;for(let t of p){let i=b[t.item.id];if(!i||!i.bonus||"radiusIncrease"!==i.bonus.type)continue;let r=a.width||1,n=a.height||1,l=!1;for(let a=0;a<n;a++){for(let o=0;o<r;o++){let r=e.x+o,n=e.y+a;if(Math.max(Math.abs(r-t.x),Math.abs(n-t.y))<=i.bonus.radius){l=!0;break}}if(l)break}l&&(o+=i.bonus.value)}f[t]=o}let h={},S=new Set,w={},T={};for(let t of Object.values(e.gridData)){if(!t.item)continue;let a=b[t.item.id];if(!a)continue;let o=t.item.rootTile?t.item.rootTile.x:t.x,i=t.item.rootTile?t.item.rootTile.y:t.y;if(t.x!==o||t.y!==i)continue;let r="".concat(o,",").concat(i),n=0;for(let t of(w[r]=[],m)){let s=b[t.item.id];if(!s||!s.bonus||"production"!==s.bonus.type||!s.bonus.appliesTo.includes(a.category))continue;let d="".concat(t.x,",").concat(t.y),c=f[d]||s.bonus.radius,u=t.x,p=t.y,y=u+(s.width||1)-1,m=p+(s.height||1)-1,g=u-c,v=y+c,h=p-c,S=m+c,_=!1,M=a.width||1,k=a.height||1;for(let e=0;e<k;e++){for(let t=0;t<M;t++){let a=o+t,r=i+e;if(a>=g&&a<=v&&r>=h&&r<=S){_=!0;break}}if(_)break}if(_){let a=e.playerStats.itemLevels[t.item.id]||1,o=(s.bonus.value||0)+(a-1)*l.aY.bonusValueIncrease;n+=o,T[d]=o,w[r].push(d)}}if(n>0){let e=a.width||1,t=a.height||1;for(let a=0;a<t;a++)for(let t=0;t<e;t++)S.add("".concat(o+t,",").concat(i+a))}h[r]=n}let _={},M=new Set,k=e.playerStats.waterAdjacencyLevel||1,x=1+(k-1)*l.rc.radiusIncrease;for(let t of Object.values(e.gridData)){if(!t.item)continue;let a="".concat(t.x,",").concat(t.y),o=!1;for(let i=-x;i<=x;i++){for(let r=-x;r<=x;r++){if(0===i&&0===r)continue;let n=e.gridData["".concat(t.x+i,",").concat(t.y+r)];if(n&&"water"===n.type){_[a]=l.ir,M.add(a),o=!0;break}}if(o)break}}let P={},A=new Set,D=new Set;for(let t of Object.values(e.gridData)){let a="".concat(t.x,",").concat(t.y);if(t.item&&!D.has(a)){let a=b[t.item.id];if(!a)continue;let o=a.category,i=l.LQ[o];if(i){let a=c(t.x,t.y,e.gridData,b);if(a.tiles.forEach(e=>D.add("".concat(e.x,",").concat(e.y))),a.size>=i.threshold){let t=e.playerStats.groupLevels[o]||1,n=t>1?(t-1)*l.tS.bonusMultiplier:0,s=i.bonus+n;if(a.tiles.forEach(e=>{let t="".concat(e.x,",").concat(e.y);A.add(t),P[t]=s}),r[o]){r[o].groupCount++;let t=0;a.tiles.forEach(a=>{var o;let i=b[a.item.id],r=(null===(o=e.playerStats.itemLevels)||void 0===o?void 0:o[i.id])||1,n=i.seedsPerSecond;if("costReduction"!==i.upgradeType&&r>1){let e="building"===i.category?l.aY:l.DJ;n=i.seedsPerSecond*(1+(r-1)*e.productionMultiplier)}t+=n*s}),r[o].groupSps+=t}}}}}let E=0,L={};for(let t in e.gridData){let a=e.gridData[t];if(!a.item||a.item.rootTile)continue;let o=b[a.item.id];if(!o)continue;let n="".concat(a.x,",").concat(a.y),l=g(o,e.playerStats,{group:P[n]||0,building:h[n]||0,water:_[n]||0});L[n]=l,E+=l,i[o.id].sps+=l,r[o.category]&&(r[o.category].sps+=l)}let R={};for(let a of Object.values(b)){let o=(null===(t=i[a.id])||void 0===t?void 0:t.count)||0;R[a.id]=function(e,t,a){var o;let i=e.cost,r=null!==(o=e.costFactor)&&void 0!==o?o:"building"===e.category?l.economy.buildingCostFactor:l.economy.costFactor,n=a[e.id]||1;if("costReduction"===e.upgradeType&&n>1){let e=l.ez.costReductionValue;for(let t=1;t<n;t++)i*=1-e}return r<=1?Math.floor(i):Math.floor(i*Math.pow(r,t))}(a,o,e.playerStats.itemLevels||{})}let C=null,F=e.selectedTileKey||e.activeTooltipTileKey,O=new Set,U=new Set;if(e.activeTooltipTileKey){let t=e.gridData[e.activeTooltipTileKey];if(null==t?void 0:null===(a=t.item)||void 0===a?void 0:a.rootTile){let a="".concat(t.item.rootTile.x,",").concat(t.item.rootTile.y);t=e.gridData[a]}t&&t.item&&(C=function(e,t,a,o,i,r){var n,l,s,d;let u;if(!e.item)return null;let p=a[e.item.id];if(!p)return null;let y="".concat(e.x,",").concat(e.y),m=c(e.x,e.y,t,a),f=(null===(n=o.groupLevels)||void 0===n?void 0:n[p.category])||1,v=i.buildingBonuses[y]||0,h=i.waterBonuses[y]||0,S=i.groupBonuses[y]||0,b=g(p,o,{group:S,building:v,water:h}),w=0,T=[];if((null===(l=p.bonus)||void 0===l?void 0:l.type)==="production"){let e=p.bonus.radius;w=(i.effectiveRadii[y]||e)-e,u=i.totalBuildingBonusValues[y]||0}else if((null===(s=p.bonus)||void 0===s?void 0:s.type)==="radiusIncrease"){let o=p.bonus.radius;for(let i=-o;i<=o;i++)for(let r=-o;r<=o;r++){let o=t["".concat(e.x+r,",").concat(e.y+i)];if(o&&o.item&&!o.item.rootTile){let e=a[o.item.id];(null==e?void 0:null===(d=e.bonus)||void 0===d?void 0:d.type)==="production"&&T.push({name:e.name,id:o.item.id})}}}return{tile:e,group:m,groupLevel:f,groupBonus:S,buildingBonus:v,waterBonus:h,radiusBonus:w,affectedBuildings:T,sps:b,sourceBuildingKeys:r[y]||[],totalBuildingBonusValue:u}}(t,e.gridData,b,e.playerStats,{buildingBonuses:h,waterBonuses:_,groupBonuses:P,effectiveRadii:f,totalBuildingBonusValues:T},w))}if(F){let t=e.gridData[F];if(null==t?void 0:null===(o=t.item)||void 0===o?void 0:o.rootTile){let a="".concat(t.item.rootTile.x,",").concat(t.item.rootTile.y);t=e.gridData[a]}if(t&&t.item){let e=b[t.item.id];if(e.bonus&&e.bonus.radius){let a="production"===e.bonus.type&&f[F]||e.bonus.radius,o=t.x,i=t.y,r=o+(e.width||1)-1,n=i+(e.height||1)-1,l=o-a,s=r+a,d=i-a,c=n+a;for(let e=d;e<=c;e++)for(let t=l;t<=s;t++)O.add("".concat(t,",").concat(e));U.add(F)}w[F]&&(U=new Set([...U,...w[F]]))}}let j={totalSeedsPerSecond:E,itemStats:i,categoryStats:r},G=function(e,t,a){let{totalSeedsPerSecond:o,itemStats:i,categoryStats:r}=e;if(!t)return[];let n=[];for(let e in i){var s;let o;let r=i[e];if(0===r.count)continue;let d=a[e];if(!d)continue;let c=d.seedsPerSecond>0,u="building"===d.category&&(null===(s=d.bonus)||void 0===s?void 0:s.type)==="production",p="radiusIncrease"===d.upgradeType,m="costReduction"===d.upgradeType;if(!c&&!u&&!m&&!p)continue;let f=t.playerStats.itemLevels[e]||1,g="building"===d.category,v=Math.floor((o=m?l.ez:p?l.aY:g?l.aY:l.DJ).itemCountRequirement*Math.pow(o.itemCountRequirementFactor,f-1));if(r.count>=v){let t=f+1,i=y(a[e].cost*o.costMultiplier,f,o.costFactor),s="Upgrade to Level ".concat(t,". Requires ").concat(v," owned."),c=0;if(m){let e=100*l.ez.costReductionValue;s="Reduces next purchase cost by ".concat(e.toFixed(0),"%.")}else p?s="+".concat(d.bonus.value," to radius of nearby buildings."):u?(s="+".concat(100*l.aY.bonusValueIncrease,"% to bonus effectiveness."),c=0):(s="+".concat(100*o.productionMultiplier,"% production boost."),c=r.sps/r.count*o.productionMultiplier*r.count);n.push({upgradeType:"item",itemId:e,name:d.name,description:s,nextLevel:t,cost:i,isAvailable:!0,imageUrl:d.imageUrl,emoji:d.emoji,placeableOn:d.placeableOn,spsIncrease:c})}}let d=l.tS;for(let e in l.LQ){let a=r[e];if(!a||!a.groupCount||0===a.groupCount)continue;let o=l.LQ[e],s=t.playerStats.groupLevels[e]||1,c=Math.floor(d.groupCountRequirement*Math.pow(d.groupCountRequirementFactor,s-1));if(a.groupCount>=c){let t=y(d.costMultiplier,s,d.costFactor),a=s+1,r=0;Object.values(i).forEach(t=>{t.item.category===e&&(r+=t.item.seedsPerSecond*t.count)});let l=r*d.bonusMultiplier,u=v[e];n.push({upgradeType:"group",itemId:e,name:"".concat(o.name," Bonus"),description:"Boosts ".concat(o.name," bonus by a fixed +").concat((100*d.bonusMultiplier).toFixed(0),"%. Requires ").concat(c," ").concat(o.name,"(s)."),nextLevel:a,cost:t,isAvailable:!0,imageUrl:u,placeableOn:["vegetable"===e?"dirt":"grass"],spsIncrease:l})}}for(let e in l.SR){let a=l.SR[e],i=t.playerStats.globalLevels[e]||1,r=i+1,s=a.unlockTrigger.base*Math.pow(a.unlockTrigger.factor,i-1);if(t.playerStats.totalSeedsProduced>=s){let t=y(a.costBase,i,a.costFactor),s=0,d="",c="";"production"===e?(s=o*a.bonusValue,d="/items/icon-production.png",c="Boosts all production by an additional ".concat(100*a.bonusValue,"%.")):"click"===e&&(s=0,d="/items/icon-hand.png",c="Adds a +".concat(100*l.SR.click.bonusValue,"% bonus to each manual click.")),n.push({upgradeType:"global",itemId:e,name:a.name,description:c,nextLevel:r,cost:t,isAvailable:!0,imageUrl:d,spsIncrease:s})}}let c=l.rc,u=t.playerStats.waterAdjacencyLevel||1,p=c.unlockTrigger.base*Math.pow(c.unlockTrigger.factor,u-1);if(t.playerStats.totalSeedsProduced>=p){let e=y(c.costMultiplier,u,c.costFactor),t=u+1,a=(t-1)*c.radiusIncrease;n.push({upgradeType:"water",itemId:"waterAdjacency",name:"Expanded Irrigation",description:"Increases water bonus radius to ".concat(1+a," tiles."),nextLevel:t,cost:Math.floor(e),isAvailable:!0,imageUrl:"/items/icon-water.png"})}return n.sort((e,t)=>e.cost-t.cost)}(j,e,b),B=I(!0,j,e);return{totalSeedsPerSecond:E,unlockedItems:s,itemStats:i,categoryStats:r,allGroupTileKeys:A,waterAdjacentTileKeys:M,bonusesByTile:h,availableUpgrades:G,bonusRadiusTiles:O,sourceBuildingsByTile:U,activeTooltip:C,missionProgress:B,nextCosts:R,effectiveRadii:f}}catch(e){return _.postMessage({type:"WORKER_ERROR",payload:{error:e.message,stack:e.stack}}),{totalSeedsPerSecond:0,itemStats:{},categoryStats:{},allGroupTileKeys:new Set,waterAdjacentTileKeys:new Set,bonusesByTile:{},bonusRadiusTiles:new Set,availableUpgrades:[],activeTooltip:null,missionProgress:{},nextCosts:{},unlockedItems:[]}}},P=()=>{if(!S)return!1;let e=new Set(S.playerStats.unlockedAchievements),t=!1;return p.forEach(a=>{if(e.has(a.id))return;let o=!1,{condition:i}=a;switch(i.type){case"totalSeeds":S.playerStats.totalSeedsProduced>=i.value&&(o=!0);break;case"itemCount":k(i.itemId,S)>=i.value&&(o=!0);break;case"level":S.playerStats.level>=i.value&&(o=!0)}if(o){t=!0,e.add(a.id),S.playerStats.unlockedAchievements.push(a.id);let{reward:o}=a;if("instantSeeds"===o.type&&(S.playerStats.seeds+=o.value),"categoryMultiplier"===o.type){let e=o.category;e&&(S.playerStats.categoryMultipliers||(S.playerStats.categoryMultipliers={}),S.playerStats.categoryMultipliers[e]||(S.playerStats.categoryMultipliers[e]=1),S.playerStats.categoryMultipliers[e]*=o.value)}self.postMessage({type:"ACHIEVEMENT_UNLOCKED",payload:a})}}),t},I=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;if(!a)return!!e&&{};let o=new Set(a.playerStats.completedMissions||[]),i=!1,r={};if(!t)return!!e&&{};let{categoryStats:n,itemStats:l}=t;return n&&l?(h.forEach(t=>{let{condition:s}=t,d=s.value,c=0;if(o.has(t.id))return;let u=!1;switch(s.type){case"manualSeeds":c=a.playerStats.manualSeedsGenerated||0;break;case"upgrades":c=a.playerStats.upgradesPurchased||0;break;case"itemCount":var p,y;s.itemId?c=(null===(p=l[s.itemId])||void 0===p?void 0:p.count)||0:s.category&&(c=(null===(y=n[s.category])||void 0===y?void 0:y.count)||0);break;case"groupCount":{let e=n[s.category];c=(null==e?void 0:e.groupCount)||0}}r[t.id]={current:c,target:d},c>=d&&(u=!0),u&&!e&&(i=!0,o.add(t.id),a.playerStats.completedMissions.push(t.id),a.playerStats.seeds+=t.reward,self.postMessage({type:"MISSION_COMPLETED",payload:t}))}),e?r:i):!!e&&{}},A=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!S)return;let{totalSeedsPerSecond:t,itemStats:a,categoryStats:o,allGroupTileKeys:i,waterAdjacentTileKeys:r,bonusesByTile:n,availableUpgrades:l,bonusRadiusTiles:s,sourceBuildingsByTile:d,activeTooltip:c,missionProgress:u,nextCosts:p,unlockedItems:y}=x(S);S.totalSeedsPerSecond=t;let m=JSON.parse(JSON.stringify(S));delete m.gridData,_.postMessage({type:"STATE_UPDATED",payload:{gridData:S.gridData,playerStats:S.playerStats,worldSeed:S.worldSeed,unlockedItems:y,totalSeedsPerSecond:t,itemStats:a,categoryStats:o,allGroupTileKeys:Array.from(i),waterAdjacentTileKeys:Array.from(r),bonusesByTile:n,availableUpgrades:l,rawGameState:m,bonusRadiusTiles:Array.from(s),bonusSourceTileKeys:Array.from(d),activeTooltip:e?null:c,missionProgress:u,nextCosts:p,selectedTileKey:S.selectedTileKey}})},D=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!S)return;let t=x(S);t&&(I(!1,t,S),P(),A(e))},E=()=>{clearInterval(T),T=setInterval(()=>{if(S){S.lastSaveTimestamp=Date.now();try{let e=JSON.stringify(S);_.postMessage({type:"SAVE_STATE_TO_LS",payload:e})}catch(e){console.error("Failed to save game state from worker",e)}}},5e3)};o.Jj({initialize:function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_=self,M=new Set;let o=function(e){let{baseProduction:t,productionGrowthFactor:a,baseCost:o,costGrowthFactor:i,costFactor:r,buildingCostFactor:n,bonusValueFactor:s}=l.economy;return[...e].sort((e,t)=>e.difficulty-t.difficulty).map((e,l)=>{var d,c,u,p,y;let m=null!==(c=e.seedsPerSecond)&&void 0!==c?c:t*Math.pow(a,e.difficulty-1),f=null!==(u=e.cost)&&void 0!==u?u:o*Math.pow(i,e.difficulty-1),g=r;"building"===e.category&&(g=n);let v={...e,seedsPerSecond:"building"===e.category?0:Math.round(100*m)/100,cost:Math.floor(f),costFactor:null!==(p=e.costFactor)&&void 0!==p?p:g};if("building"===v.category&&(null===(d=v.bonus)||void 0===d?void 0:d.type)==="production"){let t=null!==(y=v.bonus.value)&&void 0!==y?y:e.difficulty*s;v.bonus.value=Math.round(100*t)/100}return v})}(e);b=o.reduce((e,t)=>(e[t.id]=t,e),{});let i=!1;if(t&&!a.isReset){let e=function(e){if(!e)return null;let t=e.playerStats||{},a={worldName:t.worldName||"My World",avatarUrl:t.avatarUrl||"/items/avatar_man.png",seeds:t.seeds||0,totalSeedsProduced:t.totalSeedsProduced||0,manualSeedsGenerated:t.manualSeedsGenerated||0,upgradesPurchased:t.upgradesPurchased||0,totalTimePlayed:t.totalTimePlayed||0,level:t.level||1,xpForCurrentLevel:t.xpForCurrentLevel||0,xpForNextLevel:t.xpForNextLevel||l.OF.Q7,unlockedAchievements:Array.isArray(t.unlockedAchievements)?t.unlockedAchievements:[],completedMissions:Array.isArray(t.completedMissions)?t.completedMissions:[],itemLevels:t.itemLevels||{},groupLevels:t.groupLevels||{},globalLevels:t.globalLevels||{},waterAdjacencyLevel:t.waterAdjacencyLevel||1,categoryMultipliers:t.categoryMultipliers||{},homePosition:t.homePosition||{x:0,y:0}};return{gridData:e.gridData||{},playerStats:a,worldSeed:e.worldSeed||0,lastSaveTimestamp:e.lastSaveTimestamp||Date.now(),totalSeedsPerSecond:e.totalSeedsPerSecond||0,isRaining:e.isRaining||!1,rainStartTime:e.rainStartTime||0,activeTooltipTileKey:e.activeTooltipTileKey||null,checksum:e.checksum}}(t),{totalSeedsPerSecond:a}=x(e),o=(Date.now()-e.lastSaveTimestamp)/1e3;if(o>5&&a>0){let t=Math.floor(a*o);t>0&&(e.playerStats.seeds+=t,e.playerStats.totalSeedsProduced+=t,_.postMessage({type:"TOAST",payload:{title:"Welcome Back!",message:"While you were away, your world generated ~".concat(t.toLocaleString()," \uD83C\uDF31.")}}))}o>0&&(e.playerStats.totalTimePlayed+=o),S=e}else i=!0,S=s(b,a);let{unlockedItems:r}=x(S);M=new Set(r.map(e=>e.id));let n=f(S.playerStats.totalSeedsProduced);S.playerStats.level=n,S.playerStats.xpForCurrentLevel=m(n),S.playerStats.xpForNextLevel=m(n+1),_.postMessage({type:"GAME_INITIALIZED",payload:{isNewWorld:i,calculatedItems:o,unlockedItems:r,playerStats:S.playerStats}}),clearInterval(w),w=setInterval(()=>{if(!S)return;let e=.5*S.totalSeedsPerSecond;S.playerStats.seeds+=e,S.playerStats.totalTimePlayed+=.5,e>0&&(S.playerStats.totalSeedsProduced+=e);let t=f(S.playerStats.totalSeedsProduced);if(t>S.playerStats.level){let e=Math.floor(S.playerStats.seeds*l.OF.Rb);S.playerStats.seeds+=e,S.playerStats.level=t,S.playerStats.xpForCurrentLevel=m(t),S.playerStats.xpForNextLevel=m(t+1),_.postMessage({type:"LEVEL_UP",payload:{newLevel:t,rewardSeeds:e}}),D()}else{let e=x(S);if(P()||I(!1,e,S))D();else{let{missionProgress:t,nextCosts:a,unlockedItems:o}=e,i=new Set(o.map(e=>e.id));i.forEach(e=>{if(!M.has(e)){let t=b[e];t&&"home_base"!==t.id&&_.postMessage({type:"ITEM_UNLOCKED",payload:t})}}),M=new Set(i),_.postMessage({type:"STATE_UPDATED",payload:{playerStats:S.playerStats,totalSeedsPerSecond:S.totalSeedsPerSecond,missionProgress:t,nextCosts:a,unlockedItems:o,bonusRadiusTiles:Array.from(e.bonusRadiusTiles),bonusSourceTileKeys:Array.from(e.sourceBuildingsByTile)}})}}},500),E()},getInitialState:()=>S?{gridData:S.gridData,playerStats:S.playerStats,worldSeed:S.worldSeed}:null,forceFullStateUpdate:()=>{A()},resetAndGetNewState:()=>(clearInterval(w),clearInterval(T),S=s(b),E(),{gridData:S.gridData,playerStats:S.playerStats,worldSeed:S.worldSeed}),postMessage:e=>{let{type:t,payload:a}=e;if(!S&&"INIT_GAME"!==t)return;let o=!1;switch(t){case"UPDATE_WORLD_NAME":S&&S.playerStats&&(S.playerStats.worldName=a.worldName,a.avatarUrl&&(S.playerStats.avatarUrl=a.avatarUrl),_.postMessage({type:"STATE_UPDATED",payload:{playerStats:S.playerStats}}));break;case"SET_ACTIVE_TOOLTIP_TILE":S.activeTooltipTileKey=a?"".concat(a.x,",").concat(a.y):null,a&&(S.selectedTileKey=null),o=!0;break;case"SET_SELECTED_TILE":S.selectedTileKey=a?"".concat(a.x,",").concat(a.y):null,a&&(S.activeTooltipTileKey=null),o=!0;break;case"PURCHASE_WATER_UPGRADE":{let{availableUpgrades:e}=x(S),t=e.find(e=>"waterAdjacency"===e.itemId&&"water"===e.upgradeType);if(!t||S.playerStats.seeds<t.cost)return;S.playerStats.seeds-=t.cost,S.playerStats.waterAdjacencyLevel||(S.playerStats.waterAdjacencyLevel=1),S.playerStats.waterAdjacencyLevel++,S.playerStats.upgradesPurchased++,o=!0;break}case"PURCHASE_GROUP_UPGRADE":{let{groupId:e}=a;if(!e)return;let{availableUpgrades:t}=x(S),i=t.find(t=>t.itemId===e&&"group"===t.upgradeType);if(!i||S.playerStats.seeds<i.cost)return;S.playerStats.seeds-=i.cost,S.playerStats.groupLevels[e]||(S.playerStats.groupLevels[e]=1),S.playerStats.groupLevels[e]++,S.playerStats.upgradesPurchased++,o=!0;break}case"PURCHASE_GLOBAL_UPGRADE":{let{upgradeId:e}=a;if(!e)return;let{availableUpgrades:t}=x(S),i=t.find(t=>t.itemId===e&&"global"===t.upgradeType);if(!i||S.playerStats.seeds<i.cost)return;S.playerStats.seeds-=i.cost,S.playerStats.globalLevels[e]||(S.playerStats.globalLevels[e]=1),S.playerStats.globalLevels[e]++,S.playerStats.upgradesPurchased++,o=!0;break}case"PURCHASE_ITEM_UPGRADE":{let{itemId:e}=a;if(!b[e])return;let{availableUpgrades:t}=x(S),i=t.find(t=>t.itemId===e&&"item"===t.upgradeType);if(!i||S.playerStats.seeds<i.cost)return;S.playerStats.seeds-=i.cost,S.playerStats.itemLevels[e]||(S.playerStats.itemLevels[e]=1),S.playerStats.itemLevels[e]++,S.playerStats.upgradesPurchased++,o=!0;break}case"PLACE_ITEM":{let{x:e,y:t,item:i}=a,{unlockedItems:r,nextCosts:n}=x(S);if(!r.some(e=>e.id===i.id)){_.postMessage({type:"TOAST",payload:{message:"This item is locked!",variant:"destructive"}});return}let l=n[i.id]||i.cost;if(S.playerStats.seeds<l)return;let s=i.width||1,d=i.height||1;for(let a=0;a<d;a++)for(let o=0;o<s;o++){let r="".concat(e+o,",").concat(t+a),n=S.gridData[r];if(!n||n.item||!i.placeableOn.includes(n.type))return}S.playerStats.seeds-=l;let c=Date.now();for(let a=0;a<d;a++)for(let o=0;o<s;o++){let r=e+o,n=t+a,l="".concat(r,",").concat(n),u=S.gridData[l],p=0===o&&0===a,y=o===s-1&&a===d-1;S.gridData[l]={...u,item:{id:i.id,placedAt:c,rootTile:p?void 0:{x:e,y:t},isRenderTile:y}}}o=!0;break}case"REMOVE_ITEM":{let{x:e,y:t,item:i}=a;if("home_base"===i.id){_.postMessage({type:"TOAST",payload:{message:"You cannot delete your starting home!",variant:"destructive"}});return}let r=i.width||1,n=i.height||1;for(let a=0;a<r;a++)for(let o=0;o<n;o++){let i=S.gridData["".concat(e+a,",").concat(t+o)];i&&delete i.item}o=!0;break}case"MOVE_ITEM":{let{from:e,to:t,item:i}=a,r=S.gridData["".concat(e.x,",").concat(e.y)];if(!r||!r.item)return;let n=r.item.rootTile?r.item.rootTile.x:r.x,l=r.item.rootTile?r.item.rootTile.y:r.y,s=i.width||1,d=i.height||1,c=t.x,u=t.y;for(let e=0;e<d;e++)for(let t=0;t<s;t++){let a=c+t,o=u+e,r="".concat(a,",").concat(o),p=S.gridData[r],y=a>=n&&a<n+s&&o>=l&&o<l+d;if(!p||p.item&&!y||!i.placeableOn.includes(p.type))return}let p=S.gridData["".concat(n,",").concat(l)];if(!p||!p.item)return;let y=p.item.placedAt;for(let e=0;e<d;e++)for(let t=0;t<s;t++){let a=S.gridData["".concat(n+t,",").concat(l+e)];a&&delete a.item}for(let e=0;e<d;e++)for(let t=0;t<s;t++){let a=c+t,o=u+e,r="".concat(a,",").concat(o),n=S.gridData[r],l=0===t&&0===e,p=t===s-1&&e===d-1;S.gridData[r]={...n,item:{id:i.id,placedAt:y,rootTile:l?void 0:{x:c,y:u},isRenderTile:p}}}"home_base"===i.id&&(S.playerStats.homePosition={x:c,y:u}),S.selectedTileKey="".concat(c,",").concat(u),o=!0;break}case"DELETE_SELECTED":{let{tiles:e}=a,t=e.filter(e=>e.item&&"home_base"!==e.item.id);t.length<e.length&&_.postMessage({type:"TOAST",payload:{message:"You cannot delete your starting home!",variant:"destructive"}}),t.forEach(e=>{if(!e.item)return;let t=b[e.item.id];if(!t)return;let a=t.width||1,o=t.height||1,i=e.item.rootTile?e.item.rootTile.x:e.x,r=e.item.rootTile?e.item.rootTile.y:e.y;for(let e=0;e<a;e++)for(let t=0;t<o;t++){let a=S.gridData["".concat(i+e,",").concat(r+t)];a&&a.item&&delete a.item}}),S.selectedTileKey=null,o=!0;break}case"UPDATE_VISIBLE_CHUNKS":{let{camera:e,viewWidth:t,viewHeight:l}=a,s=-e.x/e.zoom,d=-e.y/e.zoom,c=(-e.x+t)/e.zoom,u=(-e.x+l)/e.zoom,p=Math.floor(s/1024)-1,y=Math.floor(d/1024)-1,m=Math.floor(c/1024)+1,f=Math.floor(u/1024)+1,g=new i(S.worldSeed),v=!1;for(let e=y;e<=f;e++){for(let t=p;t<=m;t++){let a="".concat(16*t,",").concat(16*e);if(!S.gridData[a]){v=!0;break}}if(v)break}if(v){_.postMessage({type:"CHUNK_GENERATION_STARTED"});let e={};for(let t=y;t<=f;t++)for(let a=p;a<=m;a++){let o="".concat(16*a,",").concat(16*t);if(!S.gridData[o]){let o=r(a,t,S.worldSeed,g);e={...e,...o}}}S.gridData={...S.gridData,...e};let t={...S.gridData},a=new Set(Object.keys(e));Object.keys(e).forEach(e=>{let o=t[e];a.add("".concat(o.x,",").concat(o.y-1)),a.add("".concat(o.x+1,",").concat(o.y)),a.add("".concat(o.x,",").concat(o.y+1)),a.add("".concat(o.x-1,",").concat(o.y))}),a.forEach(e=>{let a=t[e];if(a){let{dirtAutotile:o,grassAutotile:i,stoneAutotile:r}=n(a.x,a.y,t);t[e]={...a,dirtAutotile:o,grassAutotile:i,stoneAutotile:r}}}),S.gridData=t,o=!0}break}case"GET_GROUP":{let{x:e,y:t}=a;S.activeTooltipTileKey="".concat(e,",").concat(t),o=!0;break}case"ADD_SEEDS":{let e=function(e){var t;let a=(null===(t=e.globalLevels)||void 0===t?void 0:t.click)||1,o=l.SR.click.bonusValue;return a<=1?1:Math.floor(1*Math.pow(o,a-1))}(S.playerStats);S.playerStats.seeds+=e,S.playerStats.manualSeedsGenerated+=e,e>0&&(S.playerStats.totalSeedsProduced+=e)}}o&&D()}})}},l={};function s(e){var t=l[e];if(void 0!==t)return t.exports;var a=l[e]={exports:{}},o=!0;try{n[e](a,a.exports,s),o=!1}finally{o&&delete l[e]}return a.exports}s.m=n,s.x=function(){var e=s.O(void 0,[700],function(){return s(8263)});return s.O(e)},e=[],s.O=function(t,a,o,i){if(a){i=i||0;for(var r=e.length;r>0&&e[r-1][2]>i;r--)e[r]=e[r-1];e[r]=[a,o,i];return}for(var n=1/0,r=0;r<e.length;r++){for(var a=e[r][0],o=e[r][1],i=e[r][2],l=!0,d=0;d<a.length;d++)n>=i&&Object.keys(s.O).every(function(e){return s.O[e](a[d])})?a.splice(d--,1):(l=!1,i<n&&(n=i));if(l){e.splice(r--,1);var c=o();void 0!==c&&(t=c)}}return t},s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.f={},s.e=function(e){return Promise.all(Object.keys(s.f).reduce(function(t,a){return s.f[a](e,t),t},[]))},s.u=function(e){return"static/chunks/"+e+".86c4dfe9b25cd9f7.js"},s.miniCssF=function(e){},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.tt=function(){return void 0===t&&(t={createScriptURL:function(e){return e}},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(t=trustedTypes.createPolicy("nextjs#bundler",t))),t},s.tu=function(e){return s.tt().createScriptURL(e)},s.p="/_next/",a={263:1},s.f.i=function(e,t){a[e]||importScripts(s.tu(s.p+s.u(e)))},i=(o=self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push.bind(o),o.push=function(e){var t=e[0],o=e[1],r=e[2];for(var n in o)s.o(o,n)&&(s.m[n]=o[n]);for(r&&r(s);t.length;)a[t.pop()]=1;i(e)},r=s.x,s.x=function(){return s.e(700).then(r)},_N_E=s.x()}();